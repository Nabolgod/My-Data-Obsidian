Напишем две ручки:
```python
import asyncio
import threading # библиотека для потоков (многопоточности)
import time

@router.get("/sync/{id}", summary="Синхронная ручкаа по возврату отеля")  
def sync_get(hotel_id: int):  
    print(f"sync. Потоков: {threading.active_count()}")  
    print(f"sync. Нaчал {hotel_id}: {round(time.time(), 2)}")  
    time.sleep(3)  
    print(f"sync. Закончил {hotel_id}: {round(time.time(), 2)}")  
  
  
@router.get("/async/{id}", summary="Асинхронная ручка по возврату отеля")  
async def async_get(hotel_id: int):  
    print(f"async. Потоков: {threading.active_count()}")  
    print(f"async. Нaчал {hotel_id}: {round(time.time(), 2)}")  
    await asyncio.sleep(3)  
    print(f"async. Закончил {hotel_id}: {round(time.time(), 2)}")  
```

<mark style="background: #ADCCFFA6;">time.sleep()</mark> - имитация ответа запроса в синхронном виде.
<mark style="background: #ABF7F7A6;">asyncio.sleep()</mark> - имитация ответа запроса в асинхронном виде.
<mark style="background: #D2B3FFA6;">threading.active_count()</mark> - функция показывает сколько сейчас запущено потоков.

Воспользуемся [[aiohttp]] для создания сессии, которая будет атаковать наш сервер:
```python
import asyncio
import aiohttp # библиотека для асинхронных запросов

async def get_data(id: int, endpoint: str):
	print(f"Начал выполнение: {i}")
	url = f"http://url-локального адреса/{endpoint}"
	async with aiohttp.ClientSession() as session:
		async with session.get(url) as resp:
			print(f"Закончил выполнение: {i}")

asyncio.run(get_data(1, "sync")) # проверка работы синхронной ручки
asyncio.run(get_data(1, "async")) # проверка работы aсинхронной ручки

await asyncio.gather(
	*[get_data(i, "sync") for i in range(100)],
	*[get_data(i, "async") for i in range(100)]
)
```

В данном случае синхронная функция будет работать быстро при небольших кол-вах запросов, т.к. используется несколько потоков под капотом для их обработки. Она имеет ограничение в примерно в 40 потоков (на уровне fastapi ставится это ограничение).

Асинхронная же функция будет штатно обрабатывать и небольшое и большое кол-во запросов за самое большое время <mark style="background: #ADCCFFA6;">asyncio.sleep(3)</mark>. И это всё внутри одного потока.